"use strict";var __awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,s){function a(t){try{p(o.next(t))}catch(t){s(t)}}function r(t){try{p(o.throw(t))}catch(t){s(t)}}function p(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,r)}p((o=o.apply(t,e||[])).next())})};export var Note;!function(t){class e{constructor(t){this._message=t}static init({popupUid:t="popup"+Math.random().toString(16).slice(2),popupFadeDuration:n=500,popupLiveTime:o=2e3}){e._popupUid=t,e._popupFadeDuration=n,e._popupLiveTime=o,document.getElementById(e._popupUid)||(document.body.insertAdjacentHTML("beforeend",`<div id="${e._popupUid}" class="popup error"><span></span></div>`),document.getElementById(e._popupUid).addEventListener("click",function(){this.style.display="none"}))}getMessageLang(t=null){return __awaiter(this,void 0,void 0,function*(){let n=new URL("https://translate.yandex.net/api/v1.5/tr.json/detect"),o={key:e._ytkey,text:this._message,hint:"en,ru"};Object.keys(o).forEach(t=>n.searchParams.append(t,o[t]));let i=yield fetch(n.toString()),s=yield i.json();return s.then(t),s.lang||null})}translate(t,n="en",o="",i=this._message){return __awaiter(this,void 0,void 0,function*(){if(o===n)return i;let s=n;o&&(s=o+"-"+n);let a=new URL("https://translate.yandex.net/api/v1.5/tr.json/translate"),r={key:e._ytkey,text:i,lang:s,format:"plain"};Object.keys(r).forEach(t=>a.searchParams.append(t,r[t]));let p=yield fetch(a.toString()),l=yield p.json();return l.then(t),l.text[0]||null})}showNote(t,n=this._message){let o=document.getElementById(e._popupUid);o.classList.remove("error","ok"),o.classList.add(t),o.getElementsByTagName("span")[0].innerText=n;let i=o.animate({opacity:[0,1]},{duration:e._popupFadeDuration,fill:"forwards"});i.onfinish=function(){setTimeout(function(){i.reverse()},e._popupLiveTime),this.onfinish=null}}showOk(t=this._message){this.showNote("ok",t)}showError(t=this._message){this.showNote("error",t)}static _getCookieLang(){for(let t of document.cookie.split(";")){let n,o,i=t.split("=");if([n,o]=[i[0].trim(),i[1].trim],n===e.COOKIE_LANG_KEY)return o}return null}showTranslateNote(t,n=this._message){let o=navigator.language||e._getCookieLang(),i=this;o?this.translate(function(e){e&&void 0!==e.text&&e.text[0]&&i.showNote(t,e.text[0])},o,"",n):this.showNote(t)}showTranslateOk(t=this._message){this.showTranslateNote("ok",t)}showTranslateError(t=this._message){this.showTranslateNote("error",t)}}e.COOKIE_LANG_KEY="lang",e._ytkey="trnsl.1.1.20180205T094650Z.51484adc0d16f852.ed454d48484c510e9f0150f41067efa0c07b5df0",t.Note=e}(Note||(Note={})),Note.Note.init({}),window.note=new Note.Note;